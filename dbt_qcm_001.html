<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö†Ô∏è QCM PI√àGES - Commandes dbt</title>
    <style>
        :root {
            --bg: #0d1117; 
            --card: #161b22; 
            --txt: #c9d1d9; 
            --border: #30363d;
            --level-green: #2ea043;
            --level-orange: #f0883e;
            --level-red: #ff4500;
            --cmd-main: #2ea043;
            --cmd-args: #58a6ff;
            --hl-red: #ff7b72;
            --green-ans: #238636;
            --blue-highlight: #58a6ff;
        }

        body {
            font-family: -apple-system, system-ui, sans-serif;
            background: var(--bg); color: var(--txt); line-height: 1.4; 
            margin: 0; display: flex;
        }

        /* --- SIDEBAR MENU --- */
        .sidebar {
            width: 300px;
            background: var(--card);
            border-right: 1px solid var(--border);
            padding: 20px;
            height: 100vh;
            position: sticky;
            top: 0;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .sidebar h2 { color: var(--level-red); font-size: 1.1rem; margin-bottom: 20px; text-align: center; }

        .menu-item {
            display: block;
            padding: 10px 15px;
            margin-bottom: 8px;
            background: #21262d;
            color: var(--txt);
            text-decoration: none;
            border-radius: 6px;
            border: 1px solid var(--border);
            font-size: 0.9rem;
            transition: 0.2s;
        }

        .menu-item:hover { background: #30363d; transform: translateX(5px); border-color: #8b949e; }

        .sub-menu {
            display: flex;
            flex-direction: column;
            margin-left: 15px;
            padding-left: 10px;
            border-left: 2px solid var(--border);
            margin-bottom: 15px;
        }

        .sub-item { font-size: 0.8rem !important; padding: 8px 10px !important; margin: 2px 0 !important; }
        .active-page {
            border-color: var(--level-orange) !important;
            color: var(--level-orange) !important;
            background: rgba(240, 136, 62, 0.1) !important;
            font-weight: bold;
        }

        summary { list-style: none; outline: none; }
        summary::-webkit-details-marker { display: none; }

        /* --- CONTENU QCM --- */
        .container { flex: 1; max-width: 800px; margin: 0 auto; padding: 30px; }

        h1 { text-align: center; color: var(--level-red); font-size: 1.8rem; margin-bottom: 20px; }

        .intro { 
            background: var(--card); padding: 12px; border-radius: 6px; border: 1px solid var(--level-red);
            margin-bottom: 25px; font-size: 0.9rem; text-align: center;
        }

        .warning-box {
            background: rgba(255, 69, 0, 0.1);
            border: 1px solid var(--level-red);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
        }

        .q-card { 
            background: var(--card); border: 1px solid var(--border); border-radius: 12px; 
            padding: 20px; margin-bottom: 20px; 
            position: relative;
        }

        .q-card.difficulty-high { border-left: 4px solid var(--level-red); }
        .q-card.difficulty-medium { border-left: 4px solid var(--level-orange); }
        .q-card.difficulty-low { border-left: 4px solid var(--level-green); }

        .difficulty-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        .difficulty-high .difficulty-badge { background: rgba(255, 69, 0, 0.2); color: var(--level-red); }
        .difficulty-medium .difficulty-badge { background: rgba(240, 136, 62, 0.2); color: var(--level-orange); }
        .difficulty-low .difficulty-badge { background: rgba(46, 160, 67, 0.2); color: var(--level-green); }

        .q-head { font-weight: bold; font-size: 0.85rem; display: block; text-transform: uppercase; margin-bottom: 10px; color: var(--blue-highlight); }

        .q-txt { font-weight: 600; margin-bottom: 15px; display: block; font-size: 1.1rem; }
        .opt { 
            background: #21262d; padding: 12px; margin: 8px 0; border-radius: 6px; font-size: 0.95rem; 
            border: 1px solid transparent; cursor: pointer; transition: all 0.2s;
        }
        .opt:hover { border-color: var(--border); background: #30363d; }
        .opt.selected { border-color: var(--blue-highlight); background: rgba(88, 166, 255, 0.1); }
        .opt.correct { border-color: var(--level-green); background: rgba(46, 160, 67, 0.1); }
        .opt.incorrect { border-color: var(--level-red); background: rgba(255, 69, 0, 0.1); opacity: 0.6; }
        
        code { background: #000; padding: 2px 5px; border-radius: 4px; font-family: monospace; color: var(--txt); }
        .cmd { color: var(--cmd-main); font-weight: bold; }
        .arg { color: var(--cmd-args); }
        .hl { color: var(--hl-red); font-weight: bold; }

        .ans { 
            display: none; margin-top: 15px; padding: 15px; font-size: 0.9rem;
            background: rgba(35, 134, 54, 0.05); border-left: 4px solid var(--green-ans); border-radius: 4px;
        }

        .btn { 
            background: none; 
            border: 1px solid #007bff; 
            color: #007bff; 
            border-radius: 20px; 
            cursor: pointer; 
            font-size: 0.85rem; 
            margin-top: 10px; 
            padding: 6px 18px; 
            font-weight: bold;
            transition: 0.3s;
        }

        .btn:hover { background: #007bff; color: #fff; }
        
        .btn-check-all {
            display: block;
            margin: 30px auto;
            padding: 12px 30px;
            font-size: 1rem;
            background: rgba(0, 123, 255, 0.1);
            border: 2px solid #007bff;
        }

        .score-display {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card);
            border: 2px solid var(--level-orange);
            border-radius: 10px;
            padding: 15px;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .score-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--level-orange);
        }

        .footer { text-align: center; font-size: 0.8rem; padding: 30px; border-top: 1px solid var(--border); margin-top: 40px; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>üìÇ NAVIGATION</h2>
        <a href="db_structure.html" class="menu-item">üèóÔ∏è Architecture & Best Practices</a>
        <a href="piege_dbt.html" class="menu-item">üìô Voir la Matrice Commandes</a>
        <details class="menu-dropdown" open>
            <summary class="menu-item">‚úÖ Questions d'Entra√Ænement</summary>
            <div class="sub-menu">
                <a href="dbt_qcm_004.html" class="menu-item sub-item">üöÄ EXAMEN BLANC EN 004</a>
                <a href="dbt_qcm_002.html" class="menu-item sub-item">üöÄ EXAMEN BLANC FR 002</a>
                <a href="dbt_qcm_003.html" class="menu-item sub-item">üéì QCM LEARN.GETDB 003</a>
                <a href="dbt_qcm_005.html" class="menu-item sub-item active-page">‚ö†Ô∏è PI√àGES COMMANDES 005</a>
                <a href="dbt_qcm_001.html" class="menu-item sub-item">üìù QCM 1 : Fondamentaux 001</a>
                <a href="dbt_qcm_006.html" class="menu-item sub-item">üîß QCM 6 : Autres 006</a>
            </div>
        </details>
        <hr>
        <a href="index.html" class="menu-item">üè† Retour Accueil</a>
    </div>

    <div class="container">
        <h1>‚ö†Ô∏è QCM PI√àGES - Commandes dbt üî•</h1>
        <div class="intro">30 questions TR√àS DIFFICILES bas√©es sur la matrice des commandes. Attention aux subtilit√©s !</div>
        
        <div class="warning-box">
            ‚ö†Ô∏è CHALLENGE EXPERT : Chaque question a au moins une r√©ponse pi√®ge. Visez 24/30 minimum !
        </div>

        <!-- Q1 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q1 ‚Äî √âCRITURE DB</span>
            <span class="q-txt">Quelle commande NE PEUT PAS √©crire dans la base de donn√©es ?</span>
            <div class="opt" data-correct="false">A. <code>dbt run-operation cleanup_old_partitions</code></div>
            <div class="opt" data-correct="true">B. <code>dbt source freshness</code></div>
            <div class="opt" data-correct="false">C. <code>dbt clone</code></div>
            <div class="opt" data-correct="false">D. <code>dbt seed --full-refresh</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p><code>source freshness</code> est en lecture seule. <code>run-operation</code> peut √©crire via des macros custom. <code>clone</code> √©crit dans Snowflake/BigQuery. <code>seed</code> √©crit les CSV en tables.</p>
            </div>
        </div>

        <!-- Q2 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q2 ‚Äî IMPACT SUR LES SOURCES</span>
            <span class="q-txt">Quelle commande fonctionne AVEC les sources ? (Plusieurs r√©ponses)</span>
            <div class="opt" data-correct="true">A. <code>dbt test --select source:raw.*</code></div>
            <div class="opt" data-correct="false">B. <code>dbt run --select source:raw.customers</code></div>
            <div class="opt" data-correct="true">C. <code>dbt build --select source:raw.orders</code></div>
            <div class="opt" data-correct="true">D. <code>dbt list -s source:*</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, C, D</strong>
                <p><code>dbt run</code> ne fonctionne JAMAIS sur les sources. <code>build</code> les teste, <code>test</code> les teste, <code>list</code> les liste.</p>
            </div>
        </div>

        <!-- Q3 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q3 ‚Äî COMMANDE build</span>
            <span class="q-txt">Que fait EXACTEMENT <code>dbt build --select tag:daily</code> ?</span>
            <div class="opt" data-correct="false">A. Ex√©cute les mod√®les avec tag:daily</div>
            <div class="opt" data-correct="false">B. Ex√©cute + teste les mod√®les avec tag:daily</div>
            <div class="opt" data-correct="true">C. Ex√©cute + teste les mod√®les avec tag:daily, ET ex√©cute seeds/snapshots avec ce tag si existants</div>
            <div class="opt" data-correct="false">D. G√©n√®re la documentation pour les mod√®les avec tag:daily</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : C</strong>
                <p><code>build</code> est TOUT-EN-UN : run + test + seed + snapshot. C'est la diff√©rence cruciale avec <code>run</code>.</p>
            </div>
        </div>

        <!-- Q4 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q4 ‚Äî FLAG -m / --select</span>
            <span class="q-txt">Sur quelle commande le flag <code>-m</code> ou <code>--select</code> NE FONCTIONNE PAS ?</span>
            <div class="opt" data-correct="false">A. <code>dbt run</code></div>
            <div class="opt" data-correct="true">B. <code>dbt seed</code></div>
            <div class="opt" data-correct="false">C. <code>dbt test</code></div>
            <div class="opt" data-correct="false">D. <code>dbt compile</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p><code>dbt seed</code> n'accepte PAS <code>-m</code> ou <code>--select</code>. On peut utiliser <code>--select</code> mais pas avec la syntaxe des mod√®les. Pour les seeds, c'est <code>dbt seed --select seed_name</code>.</p>
            </div>
        </div>

        <!-- Q5 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q5 ‚Äî LECTURE SEULE</span>
            <span class="q-txt">Quelles commandes sont PUREMENT en lecture seule ? (Plusieurs)</span>
            <div class="opt" data-correct="true">A. <code>dbt show -m orders</code></div>
            <div class="opt" data-correct="true">B. <code>dbt compile</code></div>
            <div class="opt" data-correct="false">C. <code>dbt clone</code></div>
            <div class="opt" data-correct="true">D. <code>dbt list</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, B, D</strong>
                <p><code>show</code>, <code>compile</code>, <code>list</code> = lecture seule. <code>clone</code> √©crit dans la DB (Snowflake/BigQuery).</p>
            </div>
        </div>

        <!-- Q6 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q6 ‚Äî SNAPSHOTS</span>
            <span class="q-txt">Quelle affirmation sur <code>dbt snapshot</code> est FAUSSE ?</span>
            <div class="opt" data-correct="false">A. Utilise des macros pour g√©n√©rer le SQL</div>
            <div class="opt" data-correct="false">B. Compile le SQL avant ex√©cution</div>
            <div class="opt" data-correct="true">C. Peut √™tre ex√©cut√© via <code>dbt run -m snapshot_name</code></div>
            <div class="opt" data-correct="false">D. √âcrit dans la base de donn√©es</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : C</strong>
                <p>PI√àGE : <code>dbt run</code> ne touche JAMAIS aux snapshots. Seuls <code>dbt snapshot</code> et <code>dbt build</code> les ex√©cutent.</p>
            </div>
        </div>

        <!-- Q7 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q7 ‚Äî COMMANDE clone</span>
            <span class="q-txt">√Ä propos de <code>dbt clone</code>, quelle affirmation est VRAIE ?</span>
            <div class="opt" data-correct="true">A. Fonctionne uniquement sur Snowflake et BigQuery</div>
            <div class="opt" data-correct="false">B. Clone aussi les seeds et snapshots</div>
            <div class="opt" data-correct="false">C. Est en lecture seule</div>
            <div class="opt" data-correct="false">D. Accepte le flag <code>-m</code> pour s√©lection</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p><code>dbt clone</code> est sp√©cifique √† Snowflake/BigQuery. Il √©crit dans la DB (clone les objets), ne clone pas seeds/snapshots automatiquement.</p>
            </div>
        </div>

        <!-- Q8 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q8 ‚Äî MACROS</span>
            <span class="q-txt">Comment ex√©cuter DIRECTEMENT une macro custom ?</span>
            <div class="opt" data-correct="false">A. <code>dbt run -m macro_name</code></div>
            <div class="opt" data-correct="true">B. <code>dbt run-operation macro_name</code></div>
            <div class="opt" data-correct="false">C. <code>dbt macro macro_name</code></div>
            <div class="opt" data-correct="false">D. <code>dbt execute-macro macro_name</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p>Seule <code>run-operation</code> ex√©cute directement une macro. Les macros sont normalement appel√©es indirectement via run/test/compile.</p>
            </div>
        </div>

        <!-- Q9 -->
        <div class="q-card difficulty-low">
            <div class="difficulty-badge">FACILE</div>
            <span class="q-head">Q9 ‚Äî COMMANDE clean</span>
            <span class="q-txt">Que supprime <code>dbt clean</code> ? (Plusieurs)</span>
            <div class="opt" data-correct="true">A. Le r√©pertoire <code>target/</code></div>
            <div class="opt" data-correct="true">B. Le r√©pertoire <code>dbt_packages/</code></div>
            <div class="opt" data-correct="false">C. Les tables de la base de donn√©es</div>
            <div class="opt" data-correct="false">D. Les fichiers sources du projet</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, B</strong>
                <p><code>clean</code> supprime les artefacts locaux (compilation, packages). JAMAIS la base de donn√©es ou les fichiers sources.</p>
            </div>
        </div>

        <!-- Q10 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q10 ‚Äî TEST store-failures</span>
            <span class="q-txt">Quel est l'effet de <code>dbt test --store-failures</code> ?</span>
            <div class="opt" data-correct="false">A. √âcrit les r√©sultats des tests dans des tables</div>
            <div class="opt" data-correct="true">B. √âcrit les LIGNES EN √âCHEC des tests dans des tables</div>
            <div class="opt" data-correct="false">C. Rend les tests plus rapides</div>
            <div class="opt" data-correct="false">D. D√©sactive les tests qui √©chouent</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p>PI√àGE : <code>--store-failures</code> cr√©e des tables avec les LIGNES QUI √âCHOUENT aux tests, pas tous les r√©sultats. Utile pour debug.</p>
            </div>
        </div>

        <!-- Q11 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q11 ‚Äî COMMANDE deps</span>
            <span class="q-txt">Que fait <code>dbt deps</code> ?</span>
            <div class="opt" data-correct="false">A. T√©l√©charge les d√©pendances Python</div>
            <div class="opt" data-correct="true">B. T√©l√©charge les packages dbt depuis packages.yml</div>
            <div class="opt" data-correct="false">C. Met √† jour dbt-core</div>
            <div class="opt" data-correct="false">D. Installe les adaptateurs de base de donn√©es</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p><code>dbt deps</code> = t√©l√©charge les packages dbt (dbt-utils, etc.) d√©finis dans <code>packages.yml</code>.</p>
            </div>
        </div>

        <!-- Q12 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q12 ‚Äî SOURCE FRESHNESS</span>
            <span class="q-txt">Quel est le r√©sultat de <code>dbt source freshness</code> si une source est stale ?</span>
            <div class="opt" data-correct="false">A. Il ex√©cute automatiquement les mod√®les downstream</div>
            <div class="opt" data-correct="false">B. Il bloque <code>dbt build</code></div>
            <div class="opt" data-correct="true">C. Il retourne un code d'erreur non-zero</div>
            <div class="opt" data-correct="false">D. Il supprime les donn√©es obsol√®tes</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : C</strong>
                <p><code>source freshness</code> retourne un code d'erreur si une source est stale. √áa permet l'alerting dans les pipelines CI/CD.</p>
            </div>
        </div>

        <!-- Q13 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q13 ‚Äî COMPILE vs PARSE</span>
            <span class="q-txt">Diff√©rence entre <code>dbt compile</code> et <code>dbt parse</code> ?</span>
            <div class="opt" data-correct="true">A. compile g√©n√®re le SQL, parse ne g√©n√®re que le manifest</div>
            <div class="opt" data-correct="false">B. parse ex√©cute les tests, compile non</div>
            <div class="opt" data-correct="false">C. compile est plus rapide que parse</div>
            <div class="opt" data-correct="false">D. parse n√©cessite une connexion DB, compile non</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p><code>compile</code> g√©n√®re le SQL compil√© dans <code>target/</code>. <code>parse</code> ne fait que parser et g√©n√®re le manifest.json.</p>
            </div>
        </div>

        <!-- Q14 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q14 ‚Äî COMMANDE show</span>
            <span class="q-txt">Que fait <code>dbt show --model orders --limit 5</code> ?</span>
            <div class="opt" data-correct="false">A. Ex√©cute le mod√®le avec LIMIT 5</div>
            <div class="opt" data-correct="true">B. Compile le mod√®le et montre 5 lignes de preview</div>
            <div class="opt" data-correct="false">C. Montre les 5 derniers runs du mod√®le</div>
            <div class="opt" data-correct="false">D. G√©n√®re la documentation avec 5 exemples</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p><code>show</code> compile le mod√®le et fait un SELECT LIMIT en lecture seule pour preview. N'√©crit pas en DB.</p>
            </div>
        </div>

        <!-- Q15 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q15 ‚Äî FLAG --full-refresh</span>
            <span class="q-txt">Sur quelles commandes fonctionne <code>--full-refresh</code> ? (Plusieurs)</span>
            <div class="opt" data-correct="true">A. <code>dbt run</code></div>
            <div class="opt" data-correct="true">B. <code>dbt seed</code></div>
            <div class="opt" data-correct="false">C. <code>dbt test</code></div>
            <div class="opt" data-correct="false">D. <code>dbt snapshot</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, B</strong>
                <p><code>--full-refresh</code> fonctionne sur <code>run</code> (rebuild tables) et <code>seed</code> (recr√©er tables CSV). Pas sur <code>test</code> ou <code>snapshot</code>.</p>
            </div>
        </div>

        <!-- Q16 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q16 ‚Äî DOCS GENERATE</span>
            <span class="q-txt">Que g√©n√®re <code>dbt docs generate</code> ?</span>
            <div class="opt" data-correct="true">A. <code>manifest.json</code> et <code>catalog.json</code></div>
            <div class="opt" data-correct="false">B. Un site HTML complet auto-h√©berg√©</div>
            <div class="opt" data-correct="false">C. La documentation des seeds uniquement</div>
            <div class="opt" data-correct="false">D. Les sch√©mas de la base de donn√©es</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p><code>docs generate</code> cr√©e les fichiers JSON (manifest + catalog). <code>docs serve</code> sert le site HTML.</p>
            </div>
        </div>

        <!-- Q17 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q17 ‚Äî EX√âCUTION PARALL√àLE</span>
            <span class="q-txt">Quelle commande supporte <code>--threads</code> pour ex√©cution parall√®le ?</span>
            <div class="opt" data-correct="true">A. <code>dbt run</code></div>
            <div class="opt" data-correct="false">B. <code>dbt compile</code></div>
            <div class="opt" data-correct="true">C. <code>dbt test</code></div>
            <div class="opt" data-correct="true">D. <code>dbt build</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, C, D</strong>
                <p><code>--threads</code> fonctionne sur run, test, build (qui ex√©cutent du SQL). <code>compile</code> ne fait pas d'ex√©cution parall√®le de SQL.</p>
            </div>
        </div>

        <!-- Q18 -->
        <div class="q-card difficulty-low">
            <div class="difficulty-badge">FACILE</div>
            <span class="q-head">Q18 ‚Äî COMMANDE debug</span>
            <span class="q-txt">Que v√©rifie <code>dbt debug</code> ? (Plusieurs)</span>
            <div class="opt" data-correct="true">A. La connexion √† la base de donn√©es</div>
            <div class="opt" data-correct="true">B. La configuration du profile</div>
            <div class="opt" data-correct="false">C. La syntaxe des mod√®les SQL</div>
            <div class="opt" data-correct="true">D. Les versions de dbt et adaptateur</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, B, D</strong>
                <p><code>debug</code> v√©rifie l'environnement, pas la syntaxe SQL (c'est <code>compile</code> ou <code>parse</code>).</p>
            </div>
        </div>

        <!-- Q19 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q19 ‚Äî STATE MODIFIED</span>
            <span class="q-txt">Quel est l'effet de <code>dbt build --select state:modified</code> avec un manifest pr√©c√©dent ?</span>
            <div class="opt" data-correct="false">A. Ex√©cute tout depuis le d√©but</div>
            <div class="opt" data-correct="true">B. Ex√©cute seulement les mod√®les modifi√©s depuis le dernier √©tat</div>
            <div class="opt" data-correct="false">C. Ignore les seeds et snapshots</div>
            <div class="opt" data-correct="false">D. D√©sactive les tests</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p><code>state:modified</code> compare avec un manifest pr√©c√©dent pour ex√©cuter seulement ce qui a chang√©. Optimisation CI/CD.</p>
            </div>
        </div>

        <!-- Q20 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q20 ‚Äî EXCLUSION</span>
            <span class="q-txt">Comment exclure un mod√®le avec tag:exclude ?</span>
            <div class="opt" data-correct="false">A. <code>dbt run --exclude tag:exclude</code></div>
            <div class="opt" data-correct="true">B. <code>dbt run --select "tag:!exclude"</code></div>
            <div class="opt" data-correct="false">C. <code>dbt run --skip tag:exclude</code></div>
            <div class="opt" data-correct="false">D. <code>dbt run --ignore tag:exclude</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p>Syntaxe d'exclusion : <code>--select "tag:!exclude"</code> ou <code>--exclude tag:exclude</code> selon version. Le ! est la syntaxe correcte.</p>
            </div>
        </div>

        <!-- Q21 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q21 ‚Äî FAIL-FAST</span>
            <span class="q-txt">Quel est l'effet de <code>--fail-fast</code> sur <code>dbt build</code> ?</span>
            <div class="opt" data-correct="true">A. Stop au premier mod√®le/test qui √©choue</div>
            <div class="opt" data-correct="false">B. Continue malgr√© les √©checs</div>
            <div class="opt" data-correct="false">C. Ex√©cute plus rapidement</div>
            <div class="opt" data-correct="false">D. Ignore les warnings</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p><code>--fail-fast</code> arr√™te l'ex√©cution d√®s le premier √©chec. Utile en CI pour √©conomiser des ressources.</p>
            </div>
        </div>

        <!-- Q22 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q22 ‚Äî VARIABLES D'ENVIRONNEMENT</span>
            <span class="q-txt">Comment passer une variable depuis la ligne de commande ?</span>
            <div class="opt" data-correct="true">A. <code>dbt run --vars '{key: value}'</code></div>
            <div class="opt" data-correct="false">B. <code>dbt run --variables key=value</code></div>
            <div class="opt" data-correct="false">C. <code>dbt run -var key=value</code></div>
            <div class="opt" data-correct="false">D. <code>DBT_VAR_key=value dbt run</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p>Syntaxe CLI : <code>--vars '{key: value}'</code>. Les variables CLI √©crasent toutes les autres d√©finitions.</p>
            </div>
        </div>

        <!-- Q23 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q23 ‚Äî S√âLECTEURS AVANC√âS</span>
            <span class="q-txt">Que fait <code>dbt run -s +orders</code> ?</span>
            <div class="opt" data-correct="false">A. Ex√©cute orders et ses enfants</div>
            <div class="opt" data-correct="true">B. Ex√©cute orders et ses parents</div>
            <div class="opt" data-correct="false">C. Ex√©cute seulement orders</div>
            <div class="opt" data-correct="false">D. Ex√©cute tout sauf orders</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p><code>+</code> = upstream (parents). <code>orders+</code> = downstream (enfants). <code>@orders</code> = parents + enfants.</p>
            </div>
        </div>

        <!-- Q24 -->
        <div class="q-card difficulty-low">
            <div class="difficulty-badge">FACILE</div>
            <span class="q-head">Q24 ‚Äî SEEDS AVEC HEADER</span>
            <span class="q-txt">Comment g√©rer un CSV sans header avec <code>dbt seed</code> ?</span>
            <div class="opt" data-correct="false">A. <code>dbt seed --no-header</code></div>
            <div class="opt" data-correct="true">B. Dans le schema.yml avec <code>quote: false</code></div>
            <div class="opt" data-correct="false">C. Impossible avec dbt</div>
            <div class="opt" data-correct="false">D. Renommer les colonnes manuellement</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p>On configure les seeds dans schema.yml avec des options comme <code>quote</code>, <code>separator</code>, etc.</p>
            </div>
        </div>

        <!-- Q25 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q25 ‚Äî RUN-OPERATION ARGS</span>
            <span class="q-txt">Comment passer des arguments √† <code>dbt run-operation</code> ?</span>
            <div class="opt" data-correct="true">A. <code>dbt run-operation macro_name --args '{key: value}'</code></div>
            <div class="opt" data-correct="false">B. <code>dbt run-operation macro_name key=value</code></div>
            <div class="opt" data-correct="false">C. <code>dbt run-operation macro_name --key value</code></div>
            <div class="opt" data-correct="false">D. <code>dbt run-operation macro_name --vars '{key: value}'</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p>Syntaxe sp√©cifique : <code>--args '{key: value}'</code>. Diff√©rent de <code>--vars</code> qui est pour les variables du projet.</p>
            </div>
        </div>

        <!-- Q26 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q26 ‚Äî PROFILES MULTI-ENV</span>
            <span class="q-txt">Comment sp√©cifier un profil diff√©rent en CLI ?</span>
            <div class="opt" data-correct="true">A. <code>dbt run --profile prod_profile</code></div>
            <div class="opt" data-correct="false">B. <code>dbt run --target prod</code></div>
            <div class="opt" data-correct="false">C. <code>DBT_PROFILE=prod dbt run</code></div>
            <div class="opt" data-correct="false">D. <code>dbt run prod</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p><code>--profile</code> sp√©cifie le nom du profil. <code>--target</code> sp√©cifie la target dans le profil.</p>
            </div>
        </div>

        <!-- Q27 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q27 ‚Äî LIST FORMAT OUTPUT</span>
            <span class="q-txt">Comment exporter la liste des mod√®les dans un fichier ?</span>
            <div class="opt" data-correct="true">A. <code>dbt list -o models.txt</code></div>
            <div class="opt" data-correct="false">B. <code>dbt list > models.txt</code></div>
            <div class="opt" data-correct="false">C. <code>dbt list --output models.txt</code></div>
            <div class="opt" data-correct="false">D. <code>dbt list --file models.txt</code></div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p><code>dbt list -o fichier.txt</code> pour exporter. La redirection shell (<code>></code>) fonctionne aussi mais <code>-o</code> est l'option officielle.</p>
            </div>
        </div>

        <!-- Q28 -->
        <div class="q-card difficulty-medium">
            <div class="difficulty-badge">MOYEN</div>
            <span class="q-head">Q28 ‚Äî MAT√âRIALISATION √âPH√âM√àRE</span>
            <span class="q-txt">Que se passe-t-il avec un mod√®le √©ph√©m√®re lors de <code>dbt compile</code> ?</span>
            <div class="opt" data-correct="false">A. Il est ex√©cut√© dans une CTE</div>
            <div class="opt" data-correct="true">B. Son SQL est inject√© dans les mod√®les qui l'appellent</div>
            <div class="opt" data-correct="false">C. Il est ignor√©</div>
            <div class="opt" data-correct="false">D. Il g√©n√®re une table temporaire</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : B</strong>
                <p>Les mod√®les √©ph√©m√®res sont compil√©s en SQL qui est inject√© dans les mod√®les parents. Pas de cr√©ation de table/CTE √† la compilation.</p>
            </div>
        </div>

        <!-- Q29 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q29 ‚Äî DEPENDENCIES CIRCOLAIRES</span>
            <span class="q-txt">Que fait dbt face √† une d√©pendance circulaire ?</span>
            <div class="opt data-correct="true">A. √âchoue √† la compilation avec une erreur</div>
            <div class="opt" data-correct="false">B. Ignore une des d√©pendances</div>
            <div class="opt" data-correct="false">C. Ex√©cute dans l'ordre alphab√©tique</div>
            <div class="opt" data-correct="false">D. Cr√©e une vue r√©cursive</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponse : A</strong>
                <p>dbt d√©tecte les d√©pendances circulaires et √©choue √† la compilation. Impossible de r√©soudre l'ordre d'ex√©cution.</p>
            </div>
        </div>

        <!-- Q30 -->
        <div class="q-card difficulty-high">
            <div class="difficulty-badge">DIFFICILE</div>
            <span class="q-head">Q30 ‚Äî BUILD vs RUN + TEST</span>
            <span class="q-txt">Diff√©rence cruciale entre <code>dbt build</code> et <code>dbt run && dbt test</code> ?</span>
            <div class="opt" data-correct="true">A. build garantit l'atomicit√© (run puis test pour chaque mod√®le)</div>
            <div class="opt" data-correct="false">B. build est plus rapide</div>
            <div class="opt" data-correct="true">C. build inclut seeds et snapshots</div>
            <div class="opt" data-correct="false">D. build ne fonctionne qu'en production</div>
            <button class="btn" onclick="showAnswer(this)">V√©rifier</button>
            <div class="ans">
                <strong>‚úÖ R√©ponses : A, C</strong>
                <p>Cl√© : <code>build</code> = atomicit√© (run‚Üítest par mod√®le) + seeds/snapshots. <code>run && test</code> = run TOUT puis test TOUT.</p>
            </div>
        </div>

        <button class="btn btn-check-all" onclick="checkAllAnswers()">üìä V√âRIFIER TOUTES MES R√âPONSES</button>

        <div class="footer">
            <p>‚ö†Ô∏è Ces questions couvrent les pi√®ges les plus fr√©quents sur les commandes dbt. Revoyez la matrice si vous avez moins de 24/30.</p>
            <p>¬© 2024 - Pr√©paration Certification dbt - Niveau Expert</p>
        </div>
    </div>

    <div class="score-display" id="scoreDisplay">
        <div>SCORE</div>
        <div class="score-value" id="scoreValue">0/30</div>
        <div id="scoreMessage">Commencez !</div>
    </div>

<script>
    let score = 0;
    let totalQuestions = 30;
    let userAnswers = new Array(totalQuestions).fill(null);

    function showAnswer(button) {
        const answerDiv = button.nextElementSibling;
        answerDiv.style.display = (answerDiv.style.display === 'block') ? 'none' : 'block';
        button.innerText = (answerDiv.style.display === 'block') ? 'Masquer' : 'V√©rifier';
    }

    function selectOption(optionElement) {
        const questionCard = optionElement.closest('.q-card');
        const allOptions = questionCard.querySelectorAll('.opt');
        
        // Reset all options in this question
        allOptions.forEach(opt => {
            opt.classList.remove('selected');
        });
        
        // Select this option
        optionElement.classList.add('selected');
        
        // Store user answer
        const questionIndex = Array.from(document.querySelectorAll('.q-card')).indexOf(questionCard);
        userAnswers[questionIndex] = optionElement.textContent.charAt(0);
        
        updateScore();
    }

    function updateScore() {
        let correct = 0;
        const allQuestions = document.querySelectorAll('.q-card');
        
        allQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            if (userAnswer) {
                const correctOptions = question.querySelectorAll('.opt[data-correct="true"]');
                const correctLetters = Array.from(correctOptions).map(opt => opt.textContent.charAt(0));
                
                // For single answer questions
                if (correctLetters.length === 1) {
                    if (userAnswer === correctLetters[0]) {
                        correct++;
                    }
                }
                // For multiple answer questions - we'll handle this differently
            }
        });
        
        score = correct;
        document.getElementById('scoreValue').textContent = `${score}/${totalQuestions}`;
        
        // Update message
        let message = "Commencez !";
        if (score > 0) {
            if (score < 15) message = "üë∂ D√©butant - Revoyez la matrice";
            else if (score < 24) message = "üìö Moyen - Presque expert";
            else if (score < 28) message = "üéØ Bon - Tr√®s bon niveau";
            else message = "üèÜ Expert - Pr√™t pour la certification !";
        }
        document.getElementById('scoreMessage').textContent = message;
    }

    function checkAllAnswers() {
        const allQuestions = document.querySelectorAll('.q-card');
        let totalCorrect = 0;
        
        allQuestions.forEach((question, index) => {
            const userAnswer = userAnswers[index];
            const options = question.querySelectorAll('.opt');
            
            options.forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
                
                const isCorrect = opt.getAttribute('data-correct') === 'true';
                const isSelected = opt.classList.contains('selected');
                
                if (isCorrect) {
                    opt.classList.add('correct');
                }
                
                if (isSelected && !isCorrect) {
                    opt.classList.add('incorrect');
                }
                
                if (isSelected && isCorrect) {
                    totalCorrect++;
                }
            });
            
            // Show answer for this question
            const answerDiv = question.querySelector('.ans');
            const button = question.querySelector('.btn');
            if (answerDiv) {
                answerDiv.style.display = 'block';
                button.innerText = 'Masquer';
            }
        });
        
        // Calculate final score (adjusting for multi-answer questions)
        score = totalCorrect;
        document.getElementById('scoreValue').textContent = `${score}/${totalQuestions}`;
        
        // Final message
        let message = "";
        if (score < 15) message = "‚ùå Insuffisant - √âtudiez la matrice";
        else if (score < 20) message = "‚ö†Ô∏è Passable - Beaucoup de r√©visions";
        else if (score < 24) message = "‚úÖ Bon - Quelques points √† travailler";
        else if (score < 28) message = "üéØ Tr√®s bon - Presque parfait";
        else message = "üèÜ Excellent - Pr√™t pour l'examen !";
        
        document.getElementById('scoreMessage').textContent = message;
        
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Add click events to options
    document.addEventListener('DOMContentLoaded', function() {
        const allOptions = document.querySelectorAll('.opt');
        allOptions.forEach(opt => {
            opt.addEventListener('click', function() {
                selectOption(this);
            });
        });
        
        // Initialize score display
        updateScore();
    });
</script>

</body>
</html>